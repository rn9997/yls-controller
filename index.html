<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>LocalSweat ‚Äî Home</title>
<link rel="stylesheet" href="assets/styles.css">
</head><body>
<header class="header"><div class="container nav">
  <div class="logo"><span class="mark">LS</span>LocalSweat</div>
  <nav class="row" style="gap:10px">
    <a class="btn ghost" href="index.html">Home</a>
    <a class="btn ghost" href="catalog.html">Catalog</a>
    <a class="btn ghost" href="contact.html">Contact</a>
    <a class="btn" href="cart.html">üõí <span id="cartMini">0 ‚Ä¢ $0.00</span></a>
  </nav>
  <div class="grow"></div>
  <select id="ccy" class="select" style="width:auto"><option>USD</option><option>BHD</option><option>EUR</option><option>GBP</option></select>
</div></header>

<section class="container hero">
  <div>
    <h1 style="font-size:clamp(28px,5vw,48px);line-height:1.1;margin:0">Second-hand Heat. New-level Care.</h1>
    <p class="small" style="margin-top:8px">Controllers & street merch, curated and tested. Affordable, sustainable, and ready to ship.</p>
    <div class="row" style="gap:8px;flex-wrap:wrap;margin-top:8px">
      <a class="btn primary" href="catalog.html">Shop all</a>
      <a class="btn" href="catalog.html#Controllers">Controllers</a>
      <a class="btn" href="catalog.html#Merch">Merch</a>
    </div>
    <div class="row" style="gap:8px;flex-wrap:wrap;margin-top:12px">
      <span class="badge">üõ° 14-day warranty</span><span class="badge">üöö Local pickup</span><span class="badge">‚ôªÔ∏è Sustainable</span>
    </div>
  </div>
  <div class="card pimg"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSQer_sLc0jF-P8KseCnw07huyUL55hVLbGMA&s"></div>
</section>

<section class="container">
  <h2>Featured</h2>
  <div id="grid" class="grid"></div>
</section>

<div class="overlay" onclick="closeDrawer()"></div>
<aside class="drawer">
  <div class="pad row spread"><strong>Cart</strong><button class="btn ghost" onclick="closeDrawer()">‚úï</button></div>
  <div id="drawerItems" style="flex:1;overflow:auto;padding:0 12px 12px"></div>
  <div class="pad" style="border-top:1px solid var(--line)">
    <div class="row spread"><span class="small">Subtotal</span><strong id="subtotal">$0.00</strong></div>
    <div style="height:8px"></div>
    <a class="btn primary" href="cart.html">Checkout</a>
  </div>
</aside>

<footer class="footer">¬© <span id="year"></span> LocalSweat</footer>
<script src="assets/app.js"></script>
<script>
(async function(){
  bindHeader();
  const data = await loadProducts();
  const grid = document.getElementById('grid');
  const ccy = ()=> STORE.getCurrency();

  function render(){
    grid.innerHTML='';
    data.slice(0,4).forEach(p=>{
      const card = document.createElement('article');
      card.className='card';
      card.innerHTML = `
        <a href="product.html?id=${p.id}">
          <div class="pimg"><img src="${p.img}" alt="${p.name}"></div>
        </a>
        <div class="pad">
          <div class="ptitle">${p.name}</div>
          <div class="pmeta">${p.notes}</div>
          <div class="row spread" style="margin-top:8px">
            <strong>${toMoney(ccy(), p.priceUSD)}</strong>
            <div class="row" style="gap:6px">
              <a class="btn ghost" href="product.html?id=${p.id}">Details</a>
              <button class="btn primary" data-add="${p.id}">Add</button>
            </div>
          </div>
        </div>`;
      card.querySelector('[data-add]').onclick=()=>{ STORE.add(p.id,1); };
      grid.appendChild(card);
    });
  }
  document.addEventListener('currency:changed', render);
  render();

  async function renderDrawer(){
    const cart = STORE.getCart(); const products = data; const ccy = STORE.getCurrency();
    const wrap = document.getElementById('drawerItems'); wrap.innerHTML=''; let subUSD=0;
    for(const [id,qty] of Object.entries(cart)){
      const p = products.find(x=>x.id===id); if(!p) continue; const lineUSD = p.priceUSD*qty; subUSD+=lineUSD;
      const row = document.createElement('div');
      row.className='row'; row.style="gap:10px;border-bottom:1px solid var(--line);padding:10px 0";
      row.innerHTML = \`
        <img src="\${p.img}" alt="" style="width:64px;height:64px;object-fit:cover;border-radius:10px;border:1px solid var(--line)">
        <div class="grow"><div style="font-weight:600">\${p.name}</div><div class="small">\${p.condition}</div>
          <input type="number" min="1" value="\${qty}" class="input" style="width:80px;margin-top:6px">
        </div>
        <div>\${toMoney(ccy, lineUSD)}</div>
        <button class="btn ghost">Remove</button>\`;
      row.querySelector('input').onchange=e=>{ STORE.setQty(id,e.target.value); renderDrawer(); };
      row.querySelector('button').onclick=()=>{ STORE.remove(id); renderDrawer(); };
      wrap.appendChild(row);
    }
    document.getElementById('subtotal').textContent = toMoney(STORE.getCurrency(), subUSD);
  }
  renderDrawer();
  document.addEventListener('cart:changed', renderDrawer);
  document.getElementById('year').textContent = new Date().getFullYear();
})();
</script>
</body></html>
